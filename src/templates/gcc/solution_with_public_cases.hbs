#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>
#include "cJSON.h"

{{{user_code}}}

// Public test cases JSON string
const char* publicTestCasesJson = "{{{jsonEscaped public_test_cases}}}";

// Test execution function
void executeTests() {
    cJSON* root = cJSON_Parse(publicTestCasesJson);
    if (!root) {
        printf("{\"error\": \"Failed to parse test cases JSON\"}\n");
        return;
    }

    int total = cJSON_GetArraySize(root);
    int passed = 0;
    int failed = 0;
    int errors = 0;

    // Execute test cases
    for (int i = 0; i < total; i++) {
        cJSON* testCase = cJSON_GetArrayItem(root, i);
        if (!testCase) {
            errors++;
            continue;
        }
        
        cJSON* inputObj = cJSON_GetObjectItem(testCase, "input");
        cJSON* expectedObj = cJSON_GetObjectItem(testCase, "output");
        
        if (!inputObj || !expectedObj) {
            errors++;
            continue;
        }
        
        // Extract first input parameter (most common case)
        cJSON* firstInput = NULL;
        cJSON* inputParam = NULL;
        cJSON_ArrayForEach(inputParam, inputObj) {
            firstInput = inputParam;
            break;
        }
        
        if (!firstInput) {
            errors++;
            continue;
        }
        
        // Call function based on input type
        int testPassed = 0;
        if (cJSON_IsString(firstInput)) {
            // String input
            char* inputVal = firstInput->valuestring;
            if (cJSON_IsString(expectedObj)) {
                char* result = {{function_name}}(inputVal);
                if (result && strcmp(result, expectedObj->valuestring) == 0) {
                    testPassed = 1;
                }
            } else if (cJSON_IsNumber(expectedObj)) {
                int result = {{function_name}}(inputVal);
                if (result == expectedObj->valueint) {
                    testPassed = 1;
                }
            }
        } else if (cJSON_IsNumber(firstInput)) {
            // Numeric input
            int inputVal = firstInput->valueint;
            if (cJSON_IsNumber(expectedObj)) {
                int result = {{function_name}}(inputVal);
                if (result == expectedObj->valueint) {
                    testPassed = 1;
                }
            } else if (cJSON_IsString(expectedObj)) {
                char* result = {{function_name}}(inputVal);
                if (result && strcmp(result, expectedObj->valuestring) == 0) {
                    testPassed = 1;
                }
            }
        }
        
        if (testPassed) {
            passed++;
        } else {
            failed++;
        }
    }

    printf("{\"total\": %d, \"passed\": %d, \"failed\": %d, \"errors\": %d}\n", total, passed, failed, errors);
    cJSON_Delete(root);
}

int main() {
    executeTests();
    return 0;
}